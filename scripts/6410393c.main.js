var CsvDumpView=Parse.View.extend({initialize:function(){var a=this;a.getHistory().then(function(b){var c=JSON.stringify(a.toJSON(b)),d=$.parseJSON(c);return a.JSON2CSV(d)}).then(function(a){window.open("data:text/csv;charset=utf-8,"+escape(a))})},getHistory:function(){var a=new Parse.Query("itemInstance");a.equalTo("itemInstanceCode",2),a.equalTo("Deleted",!1),a.include("itemType");var b=new Parse.Query("backOrder");return b.include("itemParent"),Promise.resolve(a.find().then(function(a){return a}).then(function(a){return b.find().then(function(b){return{soldItems:a,soldBackOrders:b}}).then(function(a){return a})}).then(function(a){return a}))},toJSON:function(a){var b=_.map(a.soldBackOrders,function(a){return{status:"Backorder",id:a.id?a.id+"":"",sold:a.createdAt?Date(a.createdAt)+"":"",upc:a.get("itemType")?a.get("itemType")+"":"",manufacturer:a.get("itemParent")&&a.get("itemParent").get("Manufacturer")?a.get("itemParent").get("Manufacturer")+"":"",model:a.get("itemParent")&&a.get("itemParent").get("Model")?a.get("itemParent").get("Model")+"":"",caliber:a.get("itemParent")&&a.get("itemParent").get("Caliber")?a.get("itemParent").get("Caliber")+"":"",msrp:a.get("itemParent")&&a.get("itemParent").get("MSRP")?a.get("itemParent").get("MSRP")+"":"",dealerPrice:a.get("itemParent")&&a.get("itemParent").get("DealerPrice")?a.get("itemParent").get("DealerPrice")+"":"",cost:a.get("itemParent")&&a.get("itemParent").get("Cost")?a.get("itemParent").get("Cost")+"":"",serialNumber:a.get("serialNumber")?a.get("serialNumber")+"":""}}),c=_.map(a.soldItems,function(a){return{status:a.get("serialNumber")?"Tracked Item":"Generic Item",id:a.id?a.id+"":"",sold:a.createdAt?Date(a.createdAt)+"":"",upc:a.get("itemType")&&a.get("itemType").get("UPC")?a.get("itemType").get("UPC")+"":"",manufacturer:a.get("itemType")&&a.get("itemType").get("Manufacturer")?a.get("itemType").get("Manufacturer")+"":"",model:a.get("itemType")&&a.get("itemType").get("Model")?a.get("itemType").get("Model")+"":"",caliber:a.get("itemType")&&a.get("itemType").get("Caliber")?a.get("itemType").get("Caliber")+"":"",msrp:a.get("itemType")&&a.get("itemType").get("MSRP")?a.get("itemType").get("MSRP")+"":"",dealerPrice:a.get("itemType")&&a.get("itemType").get("DealerPrice")?a.get("itemType").get("DealerPrice")+"":"",cost:a.get("itemType")&&a.get("itemType").get("Cost")?a.get("itemType").get("Cost")+"":"",serialNumber:a.get("serialNumber")?a.get("serialNumber")+"":""}});return b.concat(c)},JSON2CSV:function(a){{var b="object"!=typeof a?JSON.parse(a):a,c="",d="";b[0]}for(var e in b[0]){var f=e+"";d+='"'+f.replace(/"/g,'""')+'",'}d=d.slice(0,-1),c+=d+"\r\n";for(var g=0;g<b.length;g++){var d="";for(var e in b[g]){var f=b[g][e]+"";d+='"'+f.replace(/"/g,'""')+'",'}d=d.slice(0,-1),c+=d+"\r\n"}return c}}),AttachForm3=Parse.View.extend({events:{},template:_.template($(".attach-form3-view").text()),initialize:function(){$(".app-container").html(this.el),this.render()},render:function(){$(this.el).append(this.template())}}),BackorderList=Parse.View.extend({events:{},template:_.template($(".backorder-list-view").text()),backorderItemTemplate:_.template($(".backorder-list-item").text()),initialize:function(){$(".app-container").html(this.el),this.render()},render:function(){$(this.el).append(this.template()),this.getBackorderItems()},getBackorderItems:function(){var a=this;$(".backorder-list-item-bound").html("");var b=new Parse.Query("backOrder");b.each(function(b){console.log(b),$(".backorder-list-item-bound").append(a.backorderItemTemplate({backorder:b.attributes?b.attributes:"",itemType:b.attributes&&b.attributes.itemType.attributes?b.attributes:"",order:b.attributes.order?b.attributes.order:""}))})}}),CustomerList=Parse.View.extend({events:{"click .create-customer":"createCustomerContainer","click .new-customer-submit":"addCustomer","click .cancel-customer":"cancelCustomerCreation","click .edit-customer":"editCustomerModal","click #close-modal":"closeModal","click .save-customer-changes":"saveCustomerChanges","click .add-order":"addOrder"},template:_.template($(".customer-list-view").text()),customerListTemplate:_.template($(".customer-list-item").text()),customerModalTemplate:_.template($(".customer-modal-template").text()),titleTemplate:_.template($(".page-title").text()),orderProgressBarTemplate:_.template($(".order-progress-bar").text()),initialize:function(){if(null===Parse.User.current()==!0)window.location.href="#",router.swap(new FrontPage);else{$("html, body").scrollTop(0),$(".progress-bar-body").html("");var a=window.location.hash.substring(1).toString();_.each($(".nav-link"),function(b){b.id==a?$(b).css("color","#ffffff"):$(b).css("color","#9d9d9d")}),$(".app-container").html(this.el),this.phoneValidate(),this.render()}},render:function(){$(this.el).html(""),$(this.el).append(this.template()),$(".put-title-here").html(this.titleTemplate()),$(".page-title").text("CUSTOMER LIST"),this.phoneValidate(),this.emailValidate(),this.getCustomers()},listIt:function(){{var a={valueNames:["company-name","company-owner","company-phone","company-email","FFL","address","city","state","zip"]};new List("contacts",a)}},closeModal:function(){console.log("closing modal"),$("body").css("overflow","visible"),$(".modal-div").html("")},phoneValidate:function(){function a(a,b){$(a).keyup(function(){$.isNumeric($(this).val())?($(".phone-number-input").css("background","white"),$(this).val().length>=b&&$(this).next("input").focus()):$(this).css("background",$(this).val().length?"rgba(255, 0, 0, 0.35)":"white")})}_.each($(".phone-number-input"),function(b,c){a(b,[3,3,4][c])}),_.each($(".zip-input"),function(b,c){a(b,[5][c])}),_.each($(".edit-phone-number-input"),function(b,c){a(b,[3,3,4][c])}),_.each($(".edit-zip-input"),function(b,c){a(b,[5][c])}),addDashes=function(a){var b=/(\D+)/g,c="",d="",e="";a.value=a.value.replace(b,""),c=a.value.substr(0,3),d=a.value.substr(3,3),e=a.value.substr(6,4),a.value=c+"-"+d+"-"+e}},emailValidate:function(){function a(a){return/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(a)}$(".email-input").keyup(function(){$(this).css("background",a($(this).val())?"white":"rgba(255, 0, 0, 0.35)"),$(this).val()<1&&$(this).css("background","white")})},createCustomerContainer:function(){console.log("open it"),$(".create-customer").attr("disabled","disabled"),$(".hidden-customer-creation").addClass("visible-customer-creation")},cancelCustomerCreation:function(){$(".create-customer-input").val(""),$(".create-customer").attr("disabled",!1),$(".hidden-customer-creation").removeClass("visible-customer-creation")},addCustomer:function(){var a=this,b=Parse.Object.extend("customer"),c=new b;return""===$(".company-input").val()?(console.log("empty"),$(".create-customer-input").val(""),$(".company-input").focus(),""):(c.set({Company:$(".company-input").val(),FirstName:$(".first-name-input").val(),LastName:$(".last-name-input").val(),Phone:parseInt($(".phone-number-input").val()),email:$(".email-input").val(),FFL:$(".ffl-input").val(),Address1:$(".address-input").val(),City:$(".city-input").val(),Zip:parseInt($(".zip-input").val()),State:$(".state-input").val()}).save(),console.log(c),a.getCustomers(),a.cancelCustomerCreation(),void 0)},getCustomers:function(){var a=this;$(".customer-list").html(""),this.query=new Parse.Query("customer"),this.query.each(function(b){$("tbody.list").append(a.customerListTemplate({customer:b.attributes,model:b}))}).then(function(){a.listIt()})},editCustomerModal:function(){var a=this,b=$(event.target).attr("name");console.log(b);var c=new Parse.Query("customer");c.limit(1500),c.equalTo("Company",b),c.first({success:function(b){$("body").css("overflow","hidden"),$(".modal-div").append(a.customerModalTemplate({customer:b.attributes,model:b})),$(".state-input").selectedIndex=b.attributes.State},error:function(a){console.log("Error: "+a.code+" "+a.message)}})},saveCustomerChanges:function(){function a(a,b){$(a).keyup(function(){$.isNumeric($(this).val())?($(".phone-number-input").css("background","white"),$(this).val().length>=b&&$(this).next("input").focus()):$(this).css("background",$(this).val().length?"rgba(255, 0, 0, 0.35)":"white")})}$(".edit-phone-number-input"),function(b,c){a(b,[3,3,4][c])},$(".edit-zip-input"),function(b,c){a(b,[5][c])};var b=this,c=$(event.target).attr("name"),d=new Parse.Query("customer");d.limit(1500),d.equalTo("Company",c),d.first({success:function(a){var c=a.attributes;a.set({Company:0!=$(".company-input").val().length?$(".company-input").val():c.Company,FirstName:0!=$(".first-name-input").val().length?$(".first-name-input").val():c.FirstName,LastName:0!=$(".last-name-input").val().length?$(".last-name-input").val():c.LastName,Phone:0!=$(".edit-phone-number-input").val().length?parseInt($(".edit-phone-number-input").val()):c.Phone,email:0!=$(".email-input").val().length?$(".email-input").val():c.email,FFL:0!=$(".ffl-input").val().length?$(".ffl-input").val():c.FFL,Address1:0!=$(".first-name-input").val().length?$(".first-name-input").val():c.Address1,City:0!=$(".city-input").val().length?$(".city-input").val():c.City,Zip:0!=$(".edit-zip-input").val().length?parseInt($(".edit-zip-input").val()):c.Zip,State:0!=$(".state-input").val().length?$(".state-input").val():c.State}).save(),console.log(a.attributes),b.closeModal(),b.getCustomers()},error:function(a){console.log("Error: "+a.code+" "+a.message)}})},addOrder:function(a){var b=this,c=new Parse.Query("customer");c.equalTo("objectId",$(a.currentTarget).attr("id")),c.first({success:function(a){b.shoppingCart={cart:[],customer:a},b.showPlaceOrder(),$(".progress-bar-body").append(b.orderProgressBarTemplate())},error:function(a){console.log(a)}})},showPlaceOrder:function(){this.inventoryList=new CustomerOrderInventoryList}}),CustomerOrderInventoryList=Parse.View.extend({events:{"click span.item-type":"itemTypeDetail","change .manufacturers":"activeManufacturer","click button.order-item":"addItemOrder","click .confirm-order-button":"swapConfirmView","click .search-all-inventory":"getAllItemTypes"},template:_.template($(".order-inventory-list-view").text()),listItemTemplate:_.template($(".order-inventory-list-item-view").text()),listItemDetailTemplate:_.template($(".order-inventory-list-detail-view").text()),shoppingCartTemplate:_.template($(".order-shopping-cart-view").text()),initialize:function(){$(".app-container").html(this.el),this.jankyAddCustomer(),this.render(),this.getAllItemTypes()},render:function(){$(this.el).append(this.template());var a=[],b=new Parse.Query("itemType");b.limit(1500),b.find(function(b){b.forEach(function(b){var c="";c=b.attributes.Manufacturer,a.push(c)});var c=[];$.each(a,function(a,b){-1===$.inArray(b,c)&&c.push(b)}),c.forEach(function(a){$(".manufacturers").append("<option class='manufacturer order-manufacturer col-md-2 btn-default btn' name='"+a+"'>"+a+"</option")})})},jankyAddCustomer:function(){{var a=router.currentView.shoppingCart.customer.attributes.Company?router.currentView.shoppingCart.customer.attributes.Company:"";router.currentView.shoppingCart.customer.attributes.Address1?router.currentView.shoppingCart.customer.attributes.Address1:"",router.currentView.shoppingCart.customer.attributes.City?router.currentView.shoppingCart.customer.attributes.City:"",router.currentView.shoppingCart.customer.attributes.State?router.currentView.shoppingCart.customer.attributes.State:""}$(".app-container").prepend('<div class="shopping-cart-bound"></div>'),$(".page-title").text(a)},swapConfirmView:function(){router.swap(new ConfirmOrderView({customer:router.currentView.shoppingCart.customer,items:router.currentView.shoppingCart.cart}))},itemTypeDetail:function(a){var b=this;$(".list").html("");var c=new Parse.Query("itemType");c.equalTo("typeName",a.currentTarget.innerHTML),c.first({success:function(a){var c=new Parse.Query("itemInstance");c.equalTo("itemType",a),c.equalTo("itemInstanceCode",void 0),c.each(function(a){$(".list").append(b.listItemDetailTemplate({item:a.attributes}))})},error:function(a){console.log(a)}})},getAllItemTypes:function(){$(".list").html("");var a=this,b=0,c=new Parse.Query("itemType");c.limit(1500),c.find(function(c){c.forEach(function(c){b+=1,c.attributes.Archived===!1&&c.attributes.Deleted===!1?$(".list").append(a.listItemTemplate({itemType:c})):console.log("archived")})}).then(function(){console.log(b),a.listIt()})},listIt:function(){{var a={valueNames:["product-id","item-type","item-description","all-inventory-number","backorder-number","item-caliber"]};new List("inventory-search",a)}},activeManufacturer:function(){console.log("it changed"),$(".manufacturer").removeClass("active"),$(event.target).addClass("active"),$(".center-number").text(""),$(".center-number").text($(".manufacturers option:selected").text()),$(".list").html("");var a=$(".manufacturers option:selected").text(),b=this,c=[];"Select Manufacturer"===a&&($(".center-number").text(""),this.getAllItemTypes(),this.listIt());var d=new Parse.Query("itemType");d.limit(1e3),d.find(function(d){d.forEach(function(d){return d.attributes.Manufacturer==a&&d.attributes.Archived===!1&&($(".list").append(b.listItemTemplate({itemType:d})),c.push(d)),c});var e=[];console.log(c);var f=new Parse.Query("itemInstance");for(f.limit(1e3),f.find(function(a){var b=[];return a.forEach(function(a){b.push(a.attributes.UPC)}),console.log(b),b}),i=0;i<c.length;i++)_.each(c[i],function(){e.push(c[i])})}).then(function(){b.listIt()})},addItemOrder:function(a){var b=this,c=!1,d=a.currentTarget.parentElement.parentElement.children[1].innerHTML;if(router.currentView.shoppingCart.cart.forEach(function(d){d[0]==a.currentTarget.getAttribute("value")&&(c=!0,d[1]+=1,b.renderCart())}),0==c){var e=[a.currentTarget.getAttribute("value"),1,d];router.currentView.shoppingCart.cart.push(e),b.renderCart()}},renderCart:function(){$(".shopping-cart-bound").html("");var a=this;router.currentView.shoppingCart.cart.forEach(function(b){console.log(b),$(".shopping-cart-bound").prepend(a.shoppingCartTemplate({item:b}))}),$(".order-hr").css("visibility","visible"),$(".confirm-order-button").css("visibility","visible")}}),FrontPage=Parse.View.extend({events:{"click .submit-sign-in":"signIn","keydown .password-input":"enterSignIn","click .close":"closeAlert"},template:_.template($(".dashboard-view").text()),titleTemplate:_.template($(".page-title").text()),initialize:function(){$(".app-container").html(this.el),this.render()},render:function(){$(this.el).append(this.template()),$(".put-title-here").html(this.titleTemplate()),$(".page-title").text("SIGN IN")},signIn:function(){this.logIn()},enterSignIn:function(a){console.log(a.which);var b=a.which;13==b&&this.signIn()},logIn:function(){var a=$(".username-input").val(),b=$(".password-input").val(),c=!0;_.each($(".sign-in-field"),function(a){return $(a).val().length<1?(console.log("it's empty, foo!"),void console.log(c)):(c=!1,console.log(c),c)}),0==c?Parse.User.logIn(a,b,{success:function(){router.swap(new ScanItem),console.log("logged in")},error:function(){$(".username-input").val(""),$(".password-input").val(""),$(".username-input").focus(),$(".alert-danger").css({visibility:"visible",height:"auto","margin-bottom":"20px",padding:"15px"}),$(".alert-danger").html('<button type="button" class="close closeAlert" aria-label="Close"><span aria-hidden="true">&times;</span></button>Oh snap!<span class="alert-link">Make sure you filled out everything </span>and try submitting again.'),_.each($(".sign-in-field"),function(a){$(a).css("border","1px solid red")}),$(".alert-danger").html(""),$(".alert-danger").html('<button type="button" class="close closeAlert" aria-label="Close"><span aria-hidden="true">&times;</span></button>Oh Snap!, it looks like your <span class="alert-link">username</span> or <span class="alert-link">password</span> is incorrect.')}}):($(".alert-danger").css({visibility:"visible",height:"auto","margin-bottom":"20px",padding:"15px"}),_.each($(".sign-in-field"),function(a){$(a).css("border","1px solid red")}))},closeAlert:function(){$(".alert-danger").css({visibility:"hidden",height:"0px","margin-bottom":"0px",padding:"0px",overflow:"hidden"})}}),InventoryList=Parse.View.extend({events:{"click span.item-type":"itemTypeDetail","change .manufacturers":"activeManufacturer","click .full-inventory":"showFullInventory","click .full-backorders":"showBackorderList","click .search-all-inventory":"getAllItemTypes","click .edit-items":"turnOnEdit","click .close":"closeEditInventoryItem","click .close-preview":"closeEditInventoryItem","click .save-item-changes":"saveItemChanges","click .edit-this-item":"editThisItem","click .filter-inventory":"openFilterOptions","click .filter-name":"filterName","click .archive-this-item":"archiveThis","click .delete-this-item":"deleteThis","click .list-archived-items":"listArchivedItems"},template:_.template($(".inventory-list-view").text()),listItemTemplate:_.template($(".inventory-list-item-view").text()),listItemDetailTemplate:_.template($(".inventory-list-detail-view").text()),titleTemplate:_.template($(".page-title").text()),editItemModal:_.template($(".edit-inventory-list-item-view").text()),initialize:function(){if(null===Parse.User.current()==!0)window.location.href="#",router.swap(new FrontPage);else{var a=this;$("html, body").scrollTop(0),$(".progress-bar-body").html("");var b=window.location.hash.substring(1).toString();_.each($(".nav-link"),function(a){a.id==b?$(a).css("color","#ffffff"):$(a).css("color","#9d9d9d")}),$(".app-container").html(this.el),a.render(),console.log(a.getManufacturers())}$(".filter-info-popup").css("display","none"),this.getAllItemTypes()},render:function(){$(this.el).append(this.template()),$(".put-title-here").html(this.titleTemplate()),$(".page-title").text("INVENTORY");var a=[],b=new Parse.Query("itemType");b.limit(1500),b.find(function(b){b.forEach(function(b){var c="";c=b.attributes.Manufacturer,a.push(c)});var c=[];$.each(a,function(a,b){-1===$.inArray(b,c)&&c.push(b)}),c.forEach(function(a){$(".manufacturers").append("<option class='manufacturer col-md-2 btn-default btn' name='"+a+"'>"+a+"</option")})})},listIt:function(){{var a={valueNames:["product-id","item-type","item-description","all-inventory-number","backorder-number","item-caliber"]};new List("inventory-search",a)}},getAllItemTypes:function(){$(".list").html("");var a=this,b=0,c=new Parse.Query("itemType");c.limit(1500),c.find(function(c){c.forEach(function(c){b+=1,c.attributes.Archived===!1&&c.attributes.Deleted===!1?$(".list").append(a.listItemTemplate({itemType:c})):console.log("archived")})}).then(function(){console.log(b),a.listIt()})},getManufacturers:function(){var a=[],b=new Parse.Query("itemType");b.limit(1500),b.find(function(b){b.forEach(function(b){var c="";c=b.attributes.Manufacturer,a.push(c)});var c=[],d=$.each(a,function(a,b){-1===$.inArray(b,c)&&c.push(b)}.then(function(){return c}));console.log(d)})},itemTypeDetail:function(a){var b=this;$(".inventory-list-detail-bound").html("");var c=new Parse.Query("itemType");c.equalTo("typeName",a.currentTarget.innerHTML),c.first({success:function(a){var c=new Parse.Query("itemInstance");c.equalTo("itemType",a),c.equalTo("itemInstanceCode",void 0),c.each(function(a){$(".inventory-list-detail-bound").append(b.listItemDetailTemplate({item:a.attributes}))})},error:function(a){console.log(a)}})},newItemView:function(a){new InventoryItemView({el:$(".inventory-list-item-bound"),model:a})},activeManufacturer:function(){$(".manufacturer").removeClass("active"),$(event.target).addClass("active"),$(".center-number").text(""),$(".center-number").text($(".manufacturers option:selected").text()),$(".list").html("");var a=$(".manufacturers option:selected").text(),b=this,c=[];"Select Manufacturer"===a&&($(".center-number").text(""),this.getAllItemTypes(),this.listIt());var d=new Parse.Query("itemType");d.limit(1e3),d.find(function(d){d.forEach(function(d){return d.attributes.Manufacturer==a&&d.attributes.Archived===!1&&($(".list").append(b.listItemTemplate({itemType:d})),c.push(d)),c});var e=[];console.log(c);var f=new Parse.Query("itemInstance");for(f.limit(1e3),f.find(function(a){var b=[];return a.forEach(function(a){b.push(a.attributes.UPC)}),console.log(b),b}),i=0;i<c.length;i++)_.each(c[i],function(){e.push(c[i])})}).then(function(){b.listIt()})},showFullInventory:function(){router.navigate("inventory/fullstock",{trigger:!0})},showBackorderList:function(){router.navigate("inventory/backorders",{trigger:!0})},turnOnEdit:function(){$(".edit-this-item").toggle()},editThisItem:function(){$(".inventory-item-modal-container").html("");var a=this,b=$(event.target).attr("name");console.log(b);var c=new Parse.Query("itemType");c.equalTo("UPC",b),c.first({success:function(b){console.log(b),$(".inventory-item-modal-container").append(a.editItemModal({itemType:b,thisAttribute:b.attributes}));var c=[],d=new Parse.Query("itemType");d.limit(1500),d.find(function(a){a.forEach(function(a){var b="";b=a.attributes.Manufacturer,c.push(b)});var b=[];$.each(c,function(a,c){-1===$.inArray(c,b)&&b.push(c)}),b.forEach(function(a){$(".item-manufacturers-list").append("<option class='manufacturer col-md-2 btn-default btn' name='"+a+"'>"+a+"</option")})}),setTimeout(function(){$(".item-manufacturers-list").val(b.attributes.Manufacturer)},400),console.log(b.attributes.Manufacturer)},error:function(a){console.log(a)}})},closeEditInventoryItem:function(){$(".inventory-item-modal-container").html(""),$("body").removeClass("modal-open"),$(".fade").removeClass("in"),console.log("here"),$(".modal").css("display","none")},openFilterOptions:function(){$(".filter-options button").toggle("button-toggle"),$(".filter-options-container").hasClass("filters-toggle")?setTimeout(function(){$(".filter-options-container").toggleClass("filters-toggle")},150):($(".filter-options-container").toggleClass("filters-toggle"),$(".pointer").css("left",$(".filter-inventory").offset().left-parseInt($(".filter-inventory").css("width"))%2-$(".app-container").offset().left)),$(".pointer").toggleClass("pointer-toggle")},filterInfo:function(){setTimeout(function(){$(".filter-info").tooltip("hide")},1e3)},stopFilterInfo:function(){$(".filter-info-popup").fadeOut("fast")},filterName:function(){var a=$(event.target).attr("id");$(".search-inventory").val(a),$(function(){setTimeout(function(){e=$.Event("keyup"),e.keyCode=49,$(".search-inventory").keypress(e)},900)}),$(".search-inventory").focus()},saveItemChanges:function(){var a=this,b=new Parse.Query("itemType");b.equalTo("objectId",$(event.target).data("id")),b.limit(1500),b.first({success:function(b){console.log(b),b.set({Caliber:0!=$(".caliber-input").val().length?$(".caliber-input").val():b.attributes.Caliber,ItemNumber:0!=$(".item-number-input").val().length?$(".item-number-input").val():b.attributes.ItemNumber,Manufacturer:$(".item-manufacturers-list").val()?$(".item-manufacturers-list").val():b.attributes.Manufacturer,Model:0!=$(".model-input").val().length?parseInt($(".model-input").val()):b.attributes.Model,UPC:0!=$(".upc-input").val().length?$(".upc-input").val():b.attributes.UPC,Cost:0!=$(".cost-input").val().length?$(".cost-input").val():b.attributes.Cost,DealerPrice:0!=$(".dealer-price-input").val().length?$(".dealer-price-input").val():b.attributes.DealerPrice,MSRP:0!=$(".msrp-input").val().length?$(".msrp-input").val():b.attributes.MSRP,Description:0!=$(".description-input").val().length?$(".description-input").val():b.attributes.Description}).save(),$(".list").html(""),a.closeEditInventoryItem(),a.activeManufacturer(),console.log(b)},error:function(a){console.log(a)}})},archiveThis:function(){var a=this,b=new Parse.Query("itemType");b.limit(1500),b.equalTo("objectId",$(event.target).data("id")),b.first({success:function(b){console.log(b),b.set("Archived",!0).save(),a.closeEditInventoryItem(),a.activeManufacturer(),$(".list").html(""),a.closeEditInventoryItem(),a.activeManufacturer(),console.log(b)},error:function(a){console.log(a)}})},listArchivedItems:function(){$(".list").html("");var a=this,b=0,c=new Parse.Query("itemType");c.limit(1500),c.find(function(c){c.forEach(function(c){b+=1,c.attributes.Archived===!0?$(".list").append(a.listItemTemplate({itemType:c})):console.log("not archived")})}).then(function(){console.log(b),a.listIt()})},deleteThis:function(){var a=this,b=new Parse.Query("itemType");b.limit(1500),b.equalTo("objectId",$(event.target).data("id")),b.first({success:function(b){console.log(b),b.set("Deleted",!0).save(),a.closeEditInventoryItem(),a.activeManufacturer(),$(".list").html(""),a.closeEditInventoryItem(),a.activeManufacturer(),console.log(b)},error:function(a){console.log(a)}})}}),FullStockList=Parse.View.extend({events:{"click .delete-item":"deleteItem"},template:_.template($(".full-stock-list-template").text()),instanceTemplate:_.template($(".stock-list-instance-template").text()),initialize:function(){null===Parse.User.current()==!0?(window.location.href="#",router.swap(new FrontPage)):($(".app-container").html(this.el),this.render())},render:function(){$(this.el).append(this.template()),this.getItems()},getItems:function(){var a=this,b=new Parse.Query("itemInstance");b.equalTo("itemInstanceCode",0),b.each(function(b){$(".inventory-list-bound").append(a.instanceTemplate({item:b.attributes,model:b}))})},deleteItem:function(a){var b=$(a.currentTarget).attr("id"),c=new Parse.Query("itemInstance");c.equalTo("objectId",$(a.currentTarget).attr("id")),c.first({success:function(a){a.destroy({success:function(){$("."+b).remove()},error:function(a){console.log(a)}})},error:function(a){console.log(a)}})}}),FullBackorderList=Parse.View.extend({events:{"click .delete-item":"deleteItem"},template:_.template($(".full-backorder-list-template").text()),instanceTemplate:_.template($(".backorder-list-instance-template").text()),initialize:function(){null===Parse.User.current()==!0?(window.location.href="#",router.swap(new FrontPage)):($(".app-container").html(this.el),this.render())},render:function(){$(this.el).append(this.template()),this.getItems()},getItems:function(){var a=this,b=new Parse.Query("backOrder");b.include("order"),b.each(function(b){var c=new Parse.Query("itemType");c.equalTo("UPC",b.attributes.itemType),c.first({success:function(c){$(".backorder-list-bound").append(a.instanceTemplate({item:b.attributes,model:b,itemType:c.attributes,order:b.attributes.order}))}})})},deleteItem:function(a){var b=($(a.currentTarget).attr("id"),new Parse.Query("backOrder"));b.equalTo("objectId",$(a.currentTarget).attr("id")),b.include("order"),b.first({success:function(a){console.log(a)},error:function(a){console.log(a)}})}}),OrderInvoice=Parse.View.extend({events:{},template:_.template($(".order-invoice-view").text()),initialize:function(){$(".app-container").html(this.el),this.render()},render:function(){$(this.el).append(this.template())}}),OrderList=Parse.View.extend({events:{"click .order-instance":"orderDetail","click .export-orders":"exportOrders","click .oldest-to-newest":"oldToNewOrders","click .newest-to-oldest":"newToOldOrders","click .preview-invoice":"getItems","click .print-preview":"printPreview","click .close-preview":"closePreview","click .filter-inventory":"openFilterOptions"},template:_.template($(".order-list-view").text()),orderInstanceTemplate:_.template($(".order-list-item-view").text()),orderDetailTemplate:_.template($(".order-detail-view").text()),titleTemplate:_.template($(".page-title").text()),viewOrderInvoice:_.template($(".final-order-instance-view").text()),invoicePreviewModal:_.template($(".invoice-preview-modal").text()),customerTemplate:_.template($(".customer-info-order-template").text()),itemInstanceTemplate:_.template($(".customer-info-order-items-template").text()),backorderInstanceTemplate:_.template($(".customer-info-backorder-template").text()),totalTemplate:_.template($(".sales-order-template-total").text()),initialize:function(){if(null===Parse.User.current()==!0)window.location.href="#",router.swap(new FrontPage);else{$("html, body").scrollTop(0),$(".progress-bar-body").html("");var a=window.location.hash.substring(1).toString();_.each($(".nav-link"),function(b){b.id==a?$(b).css("color","#ffffff"):$(b).css("color","#9d9d9d")}),$(".app-container").html(this.el),this.render(),this.getBackordered(),this.filterBackorderStatus(),$(".modal").css("display","none !important")}},render:function(){$(this.el).append(this.template()),$(".put-title-here").html(this.titleTemplate()),$(".page-title").text("ORDERS"),this.getOrders()},filterBackorderStatus:function(){var a=[];console.log(a);var b=[],c=new Parse.Query("order");c.limit(1500),c.include("customer"),c.find({success:function(b){for(i=0;i<b.length;i++)a.push(b[i].id)},error:function(){console.log("there was a testing error")}});var d=new Parse.Query("backOrder");d.limit(1500),d.equalTo("item",void 0),d.find({success:function(a){for(i=0;i<a.length;i++)b.push(a[i].attributes.order.id)}}).then(function(){var c=[];setTimeout(function(){var d=b.filter(function(a,b,c){return c.indexOf(a)===b}),e=a.filter(function(a,b,c){return c.indexOf(a)===b});_.each(e,function(a){for(i=0;i<d.length;i++)a==d[i]&&c.push(a)});_.each($(".order-instance"),function(a){for(i=0;i<c.length;i++)$(a).attr("id")===c[i]&&$(a).addClass("backordered-order")})},100)})},getAllOrders:function(){var a=new parse.Query("order");a.limit(1500),a.include("customer"),a.find({success:function(){}})},getBackordered:function(){var a=[],b=new Parse.Query("backOrder");b.find({success:function(b){var c=[],e=[];for(c.push(b),i=0;i<c.length;i++)for(d=0;d<c[i].length;d++)e.push(c[i][d].attributes.order.id);var f=e.filter(function(a,b,c){return b==c.indexOf(a)});_.each(f,function(b){a.push(b)}),console.log(a)},error:function(){console.log("error")}}).then(function(){console.log(a)})},getOrders:function(a){var b=this,a=[];$(".order-list-item-bound").html("");var c=new Parse.Query("order");c.include("customer"),c.find(function(c){console.log(c),a.push(c),_.each(c,function(a){a.attributes["void"]===!1&&$(".order-list-item-bound").append(b.orderInstanceTemplate({order:a,customer:a.attributes.customer}))}),console.log(c)}).then(function(){})},oldToNewOrders:function(){var a=this,b=[];$(".newest-to-oldest").toggle(),$(".oldest-to-newest").toggle(),$(".order-list-item-bound").html("");var c=new Parse.Query("order");c.include("customer"),c.each(function(c){console.log(c),b.push(c),c.attributes["void"]===!1&&$(".order-list-item-bound").prepend(a.orderInstanceTemplate({order:c,customer:c.attributes.customer}))}).then(function(){console.log(b)})},newToOldOrders:function(){var a=this,b=[];$(".newest-to-oldest").toggle(),$(".oldest-to-newest").toggle(),$(".order-list-item-bound").html("");var c=new Parse.Query("order");c.include("customer"),c.each(function(c){console.log(c),b.push(c),c.attributes["void"]===!1&&$(".order-list-item-bound").append(a.orderInstanceTemplate({order:c,customer:c.attributes.customer}))}).then(function(){console.log(b)})},orderDetail:function(a){var b=this;$(".order-detail-bound").html("");var c=new Parse.Query("order");c.include("customer"),c.equalTo("objectId",a.currentTarget.id),c.first(function(a){var c=new Parse.Query("itemInstance");c.include("itemType"),c.equalTo("order",a),c.each(function(a){$(".order-detail-bound").append(b.orderDetailTemplate({item:a,itemType:a.attributes.itemType}))})})},printOrderHistory:function(){$(".order-detail-bound").html("")},exportOrders:function(){var a=[];console.log("orders");var b=new Parse.Query("order");b.include("customer"),b.each(function(b){console.log(b),a.push(b),console.log(a)}).then(function(){console.log(a)})},previewInvoiceModal:function(){console.log("here"),$(".fade").toggleClass("in")},showCustomer:function(){var a=this,b=$(event.target).attr("id"),c=new Parse.Query("order");c.include("customer"),c.equalTo("objectId",b),c.first(function(b){var c=b.attributes.customer;$(".modal-title").text(c.attributes.Company),$(".customer-info").append(a.customerTemplate({customer:c,order:b}))
})},getItems:function(){var a=this,b=$(event.target).attr("id");$(".customer-info").html(""),a.showCustomer();var c=new Parse.Query("order");c.include("customer"),c.equalTo("objectId",b),c.first(function(b){console.log(b),$(".preview-modal-holder").append(a.invoicePreviewModal({order:b.attributes.customer.attributes,id:b.id})),$(".modal").css("display","block");var c=new Parse.Query("itemInstance");c.equalTo("order",a.order),c.limit(1500),c.include("itemType"),c.find({success:function(a){return a.length>0?void a.forEach(function(){}):void $(".ship-head").html("")},error:function(){console.log("Didn't find items.")}}).then(function(){a.getBackOrders(b)})})},getBackOrders:function(a){var b=this,c=new Parse.Query("backOrder");c.equalTo("order",a),c.find({success:function(a){a.forEach(function(a){var c=new Parse.Query("itemType");c.equalTo("UPC",a.attributes.itemType),c.find(function(a){b.showBackOrder(a)})})},error:function(){console.log("error")}}).then(function(){b.getTotal()})},showBackOrder:function(a){var b=a[0].attributes;$(".backorder-items").append(this.backorderInstanceTemplate({backorder:a,type:b})),$(".void-invoice-item").css("display","none")},showItem:function(a){console.log("making item template"),$(".in-stock-items").append(this.itemInstanceTemplate({item:a,type:a.attributes.itemType})),$(".void-invoice-item").css("display","none")},getTotal:function(){var a=this,b=0;$(".item-price").each(function(){var a=parseInt(this.innerHTML.replace(/\s+/g,"").replace(/\,/g,"").substr(1));b+=a}),a.showTotal(b)},showTotal:function(a){console.log(a),$(".sum-total").text(a),$(".backorder-items").append(this.totalTemplate({total:a}))},closePreview:function(){$(".modal").css("display","none"),$(".modal").remove(),$(".preview-modal-holder").html(""),$(".in-stock-items").html(""),$(".backorder-items").html("")},printPreview:function(){window.print()},openFilterOptions:function(){$(".filter-options button").toggle("button-toggle"),$(".filter-options-container").hasClass("filters-toggle")?setTimeout(function(){$(".filter-options-container").toggleClass("filters-toggle")},150):($(".filter-options-container").toggleClass("filters-toggle"),$(".pointer").css("left",$(".filter-inventory").offset().left-parseInt($(".filter-inventory").css("width"))%2-$(".app-container").offset().left)),$(".pointer").toggleClass("pointer-toggle")}}),OrderPartial=Parse.View.extend({events:{},template:_.template($(".order-partial-view").text()),initialize:function(){$(".app-container").html(this.el),this.render()},render:function(){$(this.el).append(this.template())}}),OrderStatus=Parse.View.extend({events:{},template:_.template($(".order-status-view").text()),initialize:function(){$(".app-container").html(this.el),this.render()},render:function(){$(this.el).append(this.template())}}),PlaceOrder=Parse.View.extend({events:{"click .customer-state":"getCustomer","click .states-bread":"showStates","click .customers-bread":"showCustomers","click .merchant":"showCustomer","click .accept-merchant":"acceptMerchant","click .cancel-merchant":"showStates","click .confirm-order-button":"swapConfirmView"},template:_.template($(".place-order-view").text()),customersTemplate:_.template($(".customer-by-state-view").text()),customerTemplate:_.template($(".customer-order-view").text()),titleTemplate:_.template($(".page-title").text()),shoppingCart:{customer:{},cart:[]},initialize:function(){if(null===Parse.User.current()==!0)window.location.href="#",router.swap(new FrontPage);else{$("html, body").scrollTop(0);var a=window.location.hash.substring(1).toString();_.each($(".nav-link"),function(b){b.id==a?$(b).css("color","#ffffff"):$(b).css("color","#9d9d9d")}),$(".app-container").html(this.el),this.render()}},render:function(){$(this.el).append(this.template()),$(".put-title-here").html(this.titleTemplate()),$(".page-title").text("PLACE ORDER"),this.showStates()},showStates:function(){$(".select-customer").html("");var a=["AL","AK","AZ","AR","CA","CO","CT","DE","FL","GA","HI","ID","IL","IN","IA","KS","KY","LA","ME","MD","MA","MI","MN","MS","MO","MT","NE","NV","NH","NJ","NM","NY","NC","ND","OH","OK","OR","PA","RI","SC","SD","TN","TX","UT","VT","VA","WA","WV","WI","WY","DC"];$(".order-directions").text("Choose state location of customer"),a.forEach(function(a){$(".select-customer").append('<button class="customer-state btn btn-default">'+a+"</button>")})},getCustomer:function(a){var b=this,c=a.currentTarget.innerHTML;this.merchants=[];var d=new Parse.Query("customer");d.equalTo("State",c),d.find({success:function(a){a.forEach(function(a){b.merchants.push(a)}),b.showCustomers()},error:function(){}})},showCustomers:function(){var a=this;$(".select-customer").html('<div class="crumbs"><span class="states-bread">states</span> > customers</div>'),$(".order-directions").text("Select the customer to create order"),this.merchants.forEach(function(b,c){$(".select-customer").append(a.customersTemplate({merchant:b,index:c}))})},showCustomer:function(a){$(".order-directions").text("Please confirm customer selection"),$(".select-customer").html('<div class="crumbs"><span class="states-bread">states</span> > <span class="customers-bread">customers</span> > '+a.currentTarget.innerHTML+"</div>");var b=a.currentTarget.id;this.shoppingCart.customer=this.merchants[b],$(".select-customer").append(this.customerTemplate({merchant:this.shoppingCart.customer}))},acceptMerchant:function(){$(".order-directions").text("Please select manufacturer and item types for order"),this.inventoryList=new OrderInventoryList},swapConfirmView:function(){router.swap(new ConfirmOrderView({customer:this.shoppingCart.customer,items:this.shoppingCart.cart}))}}),OrderInventoryList=Parse.View.extend({events:{"click span.item-type":"itemTypeDetail","click .manufacturer":"activeManufacturer","click button.order-item":"addItemOrder"},template:_.template($(".order-inventory-list-view").text()),listItemTemplate:_.template($(".order-inventory-list-item-view").text()),listItemDetailTemplate:_.template($(".order-inventory-list-detail-view").text()),shoppingCartTemplate:_.template($(".order-shopping-cart-view").text()),initialize:function(){$(".app-merchant-bound").html(this.el),this.render()},render:function(){$(this.el).append(this.template())},itemTypeDetail:function(a){var b=this;$(".inventory-list-detail-bound").html("");var c=new Parse.Query("itemType");c.equalTo("typeName",a.currentTarget.innerHTML),c.first({success:function(a){var c=new Parse.Query("itemInstance");c.equalTo("itemType",a),c.equalTo("itemInstanceCode",void 0),c.each(function(a){$(".inventory-list-detail-bound").append(b.listItemDetailTemplate({item:a.attributes}))})},error:function(a){console.log(a)}})},activeManufacturer:function(a){$(".manufacturer").removeClass("active"),$(event.target).addClass("active"),$(".center-number").text(""),$(".center-number").text($(event.target).text()),$(".inventory-list-item-bound").html("");var b=a.currentTarget.attributes.name.value,c=this,d=new Parse.Query("itemType");d.limit(1e3),d.equalTo("Manufacturer",b),d.find(function(a){a.forEach(function(a){a.attributes.Manufacturer==b&&$(".inventory-list-item-bound").append(c.listItemTemplate({itemType:a}))})})},addItemOrder:function(a){var b=this,c=!1,d=a.currentTarget.parentElement.parentElement.children[1].innerHTML;if(router.currentView.shoppingCart.cart.forEach(function(d){d[0]==a.currentTarget.getAttribute("value")&&(c=!0,d[1]+=1,b.renderCart())}),0==c){var e=[a.currentTarget.getAttribute("value"),1,d];router.currentView.shoppingCart.cart.push(e),b.renderCart()}},renderCart:function(){$(".shopping-cart-bound").html("");var a=this;router.currentView.shoppingCart.cart.forEach(function(b){$(".shopping-cart-bound").append(a.shoppingCartTemplate({item:b}))}),$(".shopping-cart-bound").append('<button role="button" class="btn confirm-order-button" data-toggle="modal">Check Out</button>')}}),ScanItem=Parse.View.extend({events:{"click .new-item-submit":"doesUPCexist","click .add-item":"manualAddItem","click .add-new-item":"addNewItemFields","click .cancel-new-item-creation":"cancelCreation","click .start-scanning":"startScanning","click .stop-scanning":"stopScanning","keypress .this-upc":"firstScan","keypress .this-serial-number":"secondScan","click .btn-delete-item":"deleteItem","click .standard-item-creation, .generic-item-creation":"toggleCreationType","click .no-upc":"toggleUPCoff","click .enable-upc":"toggleUPCon","change .manufacturer-list":"updateManufacturer","change .generic-manufacturer-list":"updateGenericManufacturer"},template:_.template($(".scan-item-view").text()),manualItemCreationTemplate:_.template($(".manual-item-creation-template").text()),titleTemplate:_.template($(".page-title").text()),initialize:function(){if(null===Parse.User.current()==!0)window.location.href="#",router.swap(new FrontPage);else{$("html, body").scrollTop(0),$(".progress-bar-body").html("");var a=window.location.hash.substring(1).toString();_.each($(".nav-link"),function(b){b.id==a?$(b).css("color","#ffffff"):$(b).css("color","#9d9d9d")}),$(".app-container").html(this.el);this.render();var b=new Parse.Query("customers");b.limit(1500);b.find(function(a){_.each(a,function(a){console.log(a)})})}},render:function(){$(this.el).html(this.template()),$(".put-title-here").html(this.titleTemplate()),$(".page-title").text("SCANNING")},firstScan:function(a){13==a.keyCode?(console.log($(".this-upc").val()),$(".this-serial-number").focus()):console.log("it's not ENTER!")},secondScan:function(a){13==a.keyCode?(console.log($(".this-upc").val()+", "+$(".this-serial-number").val()),this.doesUPCexist(),$(".this-upc").val(""),$(".this-serial-number").val(""),$(".this-upc").focus()):console.log("it's not ENTER!")},startScanning:function(){$(".this-upc").attr("disabled",!1),$(".this-serial-number").attr("disabled",!1),$(".this-upc").focus(),$(".start-scanning").addClass("stop-scanning"),$(".start-scanning").text("STOP SCANNING"),$(".stop-scanning").removeClass("start-scanning")},stopScanning:function(){$(".this-upc").attr("disabled",!0),$(".this-serial-number").attr("disabled",!0),$(".stop-scanning").addClass("start-scanning"),$(".stop-scanning").text("START SCANNING"),$(".start-scanning").removeClass("stop-scanning")},doesUPCexist:function(){var a=Parse.Object.extend("itemInstance"),b=new a,c=this,d=[],e="",f="",g=!1;for(d.push($(".this-upc").val()),d.push($(".this-serial-number").val()),console.log(d),i=0;i<d.length;i++)isNaN(parseInt(d[i]))?e=d[i]:f=d[i];var h=f;console.log(h);var j=new Parse.Query("itemInstance");j.limit(1500),j.find({success:function(a){for(console.log(a),console.log(e),i=0;i<a.length;i++)a[i].attributes.serialNumber===e?(c.stopScanning(),g=!0):(thisSerialNumber=e,b.set("serialNumber",thisSerialNumber),console.log(b),this.instance=b)}}).then(function(){g===!0&&alert("This Serial Number : "+e+" already exists!"),console.log(g),k()}),console.log(g);var k=function(){if(console.log(h),g===!1){var a=new Parse.Query("itemType");a.limit(1500),a.equalTo("UPC",h),a.find({success:function(a){console.log(b),console.log(a),b.set({Archived:!1,Deleted:!1,Caliber:a[0].attributes.Caliber,Cost:a[0].attributes.Cost,DealerPrice:a[0].attributes.DealerPrice,MSRP:a[0].attributes.MSRP,Description:a[0].attributes.Description,Model:a[0].attributes.Model,UPC:a[0].attributes.UPC,itemType:a[0],itemInstanceCode:0,dateSaved:Date()}).save(),$(".scanned-item-list").append('<div class="col-md-12 scanned-item-container"><div class="scanned-item-attribute col-md-3"><p>MFR: '+a[0].attributes.Manufacturer+'</p></div><div class="scanned-item-attribute col-md-4"><p>MODEL: '+a[0].attributes.Model+'</p></div><div class="scanned-item-attribute col-md-4"><p>UPC: '+a[0].attributes.UPC+'</div><div class="scanned-item-attribute col-md-1 scanned-item-icon"><i id="'+a[0].id+'" class="fa fa-trash-o"></i></div>'),console.log(b),console.log("successful! : "+a[0].attributes.UPC)}})}}},deleteItem:function(a){console.log("deleting item");var b=$(a.currentTarget).attr("id"),c=new Parse.Query("itemInstance");c.limit(1500),c.equalTo("objectId",$(a.currentTarget).attr("id")),console.log($(a.currentTarget).attr("id")),c.include("order"),c.find({success:function(a){console.log(a),a.destroy({success:function(){$("."+b).remove()},error:function(a){console.log(a)}})},error:function(a){console.log(a)}})},manualAddItem:function(){$(".add-item").attr("disabled","disabled"),$(".new-item-submit").attr("disabled","disabled");var a=this;this.stopScanning(),$(".add-here").append(a.manualItemCreationTemplate({})),$(".new-item-form").css("display","block"),$(".generic-new-item-form").css("display","none"),$(".standard-item-creation").addClass("active"),$(".no-upc").addClass("btn-info"),$(".no-upc").removeClass("btn-default"),setTimeout(function(){$(".new-item-creation").addClass("visible-item-creation")},10),console.log("added it");var b=[],c=new Parse.Query("itemType");c.limit(1500),c.find(function(a){a.forEach(function(a){var c="";c=a.attributes.Manufacturer,b.push(c)});var c=[];$.each(b,function(a,b){-1===$.inArray(b,c)&&c.push(b)}),c.forEach(function(a){$(".manufacturer-list").append("<option class='manufacturer-choice col-md-2 btn-default btn' name='"+a+"'>"+a+"</option")})})},toggleCreationType:function(){$(event.target).hasClass("standard-item-creation")?(this.toggleUPCon(),$(".generic").val(""),$(".no-upc").css("display","none"),$(".standard-item-creation").removeClass("btn-default"),$(".standard-item-creation").addClass("btn-info"),$(".new-item-form").css("display","block"),$(".generic-new-item-form").css("display","none"),$(".standard-item-creation").addClass("active"),$(".generic-item-creation").removeClass("active"),$(".generic-item-creation").addClass("btn-default"),$(".generic-item-creation").removeClass("btn-info")):$(event.target).hasClass("generic-item-creation")&&($(".standard").val(""),$(".no-upc").css("display","block"),$(".generic-item-creation").removeClass("btn-default"),$(".generic-item-creation").addClass("btn-info"),$(".new-item-form").css("display","none"),$(".generic-new-item-form").css("display","block"),$(".standard-item-creation").removeClass("active"),$(".generic-item-creation").addClass("active"),$(".standard-item-creation").addClass("btn-default"),$(".standard-item-creation").removeClass("btn-info"))},toggleUPCoff:function(){$(".no-upc").prop("disabled",!0),$(".no-upc").text("UPC OFF"),$(".generic-upc").prop("disabled",!0),$(".enable-upc").css("display","block")},toggleUPCon:function(){$(".no-upc").prop("disabled",!1),$(".no-upc").text("UPC ON"),$(".generic-upc").prop("disabled",!1),$(".enable-upc").css("display","none")},addNewItemFields:function(){if($(".standard-item-creation").hasClass("active")){var a=$(".new-item-form").find("input").filter(function(){return""===this.value});if(a.length)alert("please fill in all fields.");else{var b=Parse.Object.extend("itemType"),c=new b;c.set({Archived:!1,Deleted:!1,Manufacturer:$(".manufacturer").val(),Description:$(".description").val(),Caliber:$(".caliber").val(),Model:$(".model").val(),Cost:"$"+$(".cost").val(),DealerPrice:"$"+$(".dealer-price").val(),MSRP:"$"+$(".msrp").val(),UPC:$(".upc").val(),dateSaved:Date()}).save(),$(".scanned-item-list").append('<div class="col-md-12 scanned-item-container"><div class="scanned-item-attribute col-md-6"><p>'+c.attributes.Model+'</p></div><div class="scanned-item-attribute col-md-6"><p>'+c.attributes.UPC+"</div>"),console.log(c),$(".new-item-form").children("input").val(""),$(".new-item-form").children("textarea").val(""),$(".manufacturer").focus()}}else if($(".generic-item-creation").hasClass("active")&&$(".no-upc").prop("disabled")===!1){var a=$(".generic-new-item-form").find("input").filter(function(){return""===this.value});if(a.length)alert("please fill in all fields.");else{var b=Parse.Object.extend("itemType"),c=new b;c.set({Archived:!1,Deleted:!1,Manufacturer:$(".generic-manufacturers").val(),Description:$(".generic-description").val(),Caliber:$(".generic-caliber").val(),Model:$(".generic-model").val(),Cost:"$"+$(".generic-cost").val(),DealerPrice:"$"+$(".generic-dealer-price").val(),MSRP:"$"+$(".generic-msrp").val(),UPC:$(".generic-upc").val(),dateSaved:Date()}).save(),console.log(c);var d=[];for(i=0;i<parseInt($(".amount").val());i++){var e=Parse.Object.extend("itemInstance"),f=new e;f.set({Archived:!1,Deleted:!1,Manufacturer:$(".generic-manufacturers").val(),Description:$(".generic-description").val(),Caliber:$(".generic-caliber").val(),Model:$(".generic-model").val(),Cost:"$"+$(".generic-cost").val(),DealerPrice:"$"+$(".generic-dealer-price").val(),MSRP:"$"+$(".generic-msrp").val(),UPC:$(".generic-upc").val(),itemType:c,itemInstanceCode:0,dateSaved:Date()}).save(),d.push(f)}var g=parseInt($(".scanned-item-total").text()),h=g+d.length;$(".scanned-item-total").text(h.toString()),console.log(d),$(".scanned-item-list").append('<div class="col-md-12 scanned-item-container"><div class="scanned-item-attribute col-md-4"><p>'+f.attributes.Model+'</p></div><div class="scanned-item-attribute col-md-4"><p>'+f.attributes.UPC+'</div><div class="scanned-item-attribute col-md-4">x '+d.length+"</div>")}}else if($(".generic-item-creation").hasClass("active")&&$(".no-upc").prop("disabled")===!0){var a=$(".generic-new-item-form").find("input").filter(function(){return""===this.value});if(a.length)alert("please fill in all fields.");else{var b=Parse.Object.extend("itemType"),c=new b;c.set({Archived:!1,Deleted:!1,Manufacturer:$(".generic-manufacturers").val(),Description:$(".generic-description").val(),Caliber:$(".generic-caliber").val(),Model:$(".generic-model").val(),Cost:"$"+$(".generic-cost").val(),DealerPrice:"$"+$(".generic-dealer-price").val(),MSRP:"$"+$(".generic-msrp").val(),UPC:"NA"}).save(),console.log(c);var d=[];for(i=0;i<parseInt($(".amount").val());i++){var e=Parse.Object.extend("itemInstance"),f=new e;f.set({Archived:!1,Deleted:!1,Manufacturer:$(".generic-manufacturers").val(),Description:$(".generic-description").val(),Caliber:$(".generic-caliber").val(),Model:$(".generic-model").val(),Cost:"$"+$(".generic-cost").val(),DealerPrice:"$"+$(".generic-dealer-price").val(),MSRP:"$"+$(".generic-msrp").val(),UPC:"NA",itemType:c,itemInstanceCode:0}).save(),console.log(c),d.push(f)}var g=parseInt($(".scanned-item-total").text()),h=g+d.length;$(".scanned-item-total").text(h.toString()),console.log(f),console.log(d),$(".scanned-item-list").append('<div class="col-md-12 scanned-item-container"><div class="scanned-item-attribute col-md-4"><p>'+f.attributes.Model+'</p></div><div class="scanned-item-attribute col-md-4"><p>'+f.attributes.UPC+'</div><div class="scanned-item-attribute col-md-4">x '+d.length+"</div>")}}},cancelCreation:function(){$(".add-item").attr("disabled",!1),$(".new-item-submit").attr("disabled",!1),$(".new-item-creation").removeClass("visible-item-creation"),setTimeout(function(){$(".add-here").html("")},380),console.log("pudding")},updateManufacturer:function(){$(".manufacturer").val($(".manufacturer-list option:selected").val())},updateGenericManufacturer:function(){$(".generic-manufacturers").val($(".generic-manufacturer-list option:selected").val())}}),ShelfList=Parse.View.extend({events:{},template:_.template($(".shelf-list-view").text()),shelfItemTemplate:_.template($(".shelf-list-item").text()),initialize:function(){if(null===Parse.User.current()==!0)window.location.href="#",router.swap(new FrontPage);else{$("html, body").scrollTop(0);var a=window.location.hash.substring(1).toString();_.each($(".nav-link"),function(b){b.id==a?$(b).css("color","#ffffff"):$(b).css("color","#9d9d9d")}),$(".app-container").html(this.el),this.render()}},render:function(){$(this.el).append(this.template()),this.getShelfItems()},getShelfItems:function(){var a=this;$(".shelf-item-list-bound").html("");var b=new Parse.Query("itemInstance");b.equalTo("itemInstanceCode",0),b.each(function(b){$(".shelf-item-list-bound").append(a.shelfItemTemplate({item:b.attributes}))})}}),ConfirmOrderView=Parse.View.extend({events:{"click .update-total":"updatePage","click .confirm-list":"confirmCart"},template:_.template($(".confirm-order-view").text()),itemInstanceTemplate:_.template($(".confirm-order-item-instance-view").text()),itemTotalTemplate:_.template($(".update-order-total-view").text()),initialize:function(){$(".app-container").html(this.el),this.render()},render:function(){var a={Company:this.options.customer.attributes.Company?this.options.customer.attributes.Company:"",FirstName:this.options.customer.attributes.FirstName?this.options.customer.attributes.FirstName:"",LastName:this.options.customer.attributes.LastName?this.options.customer.attributes.LastName:"",Address1:this.options.customer.attributes.Address1?this.options.customer.attributes.Address1:"",City:this.options.customer.attributes.City?this.options.customer.attributes.City:"",State:this.options.customer.attributes.State?this.options.customer.attributes.State:"",Zip:this.options.customer.attributes.Zip?this.options.customer.attributes.Zip:"",email:this.options.customer.attributes.email?this.options.customer.attributes.email:"",Phone:this.options.customer.attributes.Phone?this.options.customer.attributes.Phone:""};$(this.el).append(this.template({customer:a})),this.getCart(),this.hideOptionInput()},renderCart:function(a){var b=this;$(".item-instance-bound").html(""),a.forEach(function(a){$(".item-instance-bound").append(b.itemInstanceTemplate({item:a}))})},getCart:function(){var a=this;this.cart=[];var b=new Promise(function(b){a.options.items.forEach(function(c,d,e){var f=new Parse.Query("itemType");f.equalTo("objectId",c[0]),f.find({success:function(b){b[0].attributes.quan=c[1],b[0].attributes.id=b[0].id,a.cart.push(b[0].attributes)},error:function(a){console.log(a)}}).then(function(){d+1===e.length&&b(a.cart)})})});b.then(function(){var b=setInterval(function(){a.cart.length===a.options.items.length?(a.renderCart(a.cart),a.showItemSum(a.sumItemCost()),clearInterval(b)):console.log("nah son")},100)})},sumItemCost:function(){var a=0;for(i=0;i<$(".total-item-cost").length;i+=1)if(a+=parseInt($(".total-item-cost")[i].innerHTML),i===$(".total-item-cost").length-1)return a},showItemSum:function(a){var b=$("#shipping").val();if(10==b||20==b){this.cart.shipping=b;var c=parseInt($("#shipping").val())+parseInt(a);$(".cart-total").html(this.itemTotalTemplate({sum:c}))}else if("Other"==b){this.cart.shipping=parseInt($("#other_cost").val());var c=parseInt($("#other_cost").val())+parseInt(a);$(".cart-total").html(this.itemTotalTemplate({sum:c}))}},updatePage:function(){var a=[];$(".cart-item-instance").each(function(b,c){a.push([c.getAttribute("id"),c.value])}),this.updateCart(a)},updateCart:function(a){this.options.items.forEach(function(b){a.forEach(function(a){b[0]==a[0]&&(b[1]=parseInt(a[1]))})}),this.getCart()},confirmCart:function(){console.log("confirmed"),console.log("cart",this.cart),confirm("Are you sure?")&&($(".item-list-bound").html(""),$(".item-total-bound").html(""),new FinalOrder(this.cart))},hideOptionInput:function(){$(function(){$("#other_cost").hide(),$("#shipping").change(function(){"Other"==$(this).find("option:selected").val()?$("#other_cost").show():$("#other_cost").hide()}),$("#other_cost").keyup(function(a){var b=$("#shipping").find("option:selected");"Other"==b.val()&&(a.preventDefault(),$(b).html($("#other_cost").val()))}),$("#form_id").submit(function(){var a=$("#shipping").find("option:selected");"Other"==a.val()&&a.val($("#other_cost").val())})})}}),FinalOrder=Parse.View.extend({events:{},template:_.template($(".final-order-instance-view").text()),initialize:function(){$(".item-list-bound").html(this.el),this.getCustomer(),this.render()},createOrder:function(a){var b=this,c=0,d=new Parse.Query("order");d.count({success:function(a){c=a,console.log(a),console.log(c)}}).then(function(){Date.prototype.getFormattedTime=function(){var a=0==this.getHours()?"12":this.getHours()>12?this.getHours()-12:this.getHours(),b=(this.getMinutes()<10?"0":"")+this.getMinutes(),c=this.getHours()<12?"AM":"PM",d=a+":"+b+" "+c;return d};var d=new Date("February 04, 2011 19:00:00").getFormattedTime(),e=new Date,f=e.toString(),g=f.slice(0,15)+" "+d,h=Parse.Object.extend("order");b.order=new h,b.order.set({customer:a,orderNumber:parseInt(c),"void":!1,date:g,shop:Parse.User.current(),shipping:b.options.shipping}).save(),b.getItems()})},getCustomer:function(){var a=this,b=new Parse.Query("customer");b.equalTo("objectId",router.currentView.options.customer.id),b.first({success:function(b){a.customer=b,a.createOrder(b)},error:function(a){console.log(a)}})},render:function(){$(this.el).append(this.template())},getItems:function(){var a=this;console.log(this.options),this.options.forEach(function(b){var c=b.quan,d=new Parse.Query("itemInstance");d.include("itemType"),d.equalTo("UPC",b.UPC),d.equalTo("itemInstanceCode",0),d.find({success:function(b){b.forEach(function(b){c>0&&(b.set("itemInstanceCode",2),b.set("order",a.order),b.save(),c-=1)})},error:function(a){console.log(a)}}).then(function(){setTimeout(function(){if(c>0)for(var d=c;d>0;d-=1)a.makeBackorder(b.UPC,a.order),c-=1,0===c&&(console.log("order",a.order.id),router.navigate("#order/"+a.order.id,{trigger:!0,replace:!0}))},200)})})},grabInstance:function(a){a.set("itemInstanceCode",2),a.set("order",this.order),a.save()},makeBackorder:function(a,b){var c=new Parse.Query("itemType");c.equalTo("UPC",a),c.first().then(function(c){var d=Parse.Object.extend("backOrder"),e=new d;e.set("itemType",a),e.set("itemParent",c),e.set("order",b),e.save()})}}),OrderInstanceView=Parse.View.extend({events:{"click .print-sales":"printSales","click .print-invoice":"printInvoice","click .void-invoice":"voidInvoiceItem"},template:_.template($(".final-order-instance-view").text()),customerTemplate:_.template($(".customer-info-order-template").text()),itemInstanceTemplate:_.template($(".customer-info-order-items-template").text()),backorderInstanceTemplate:_.template($(".customer-info-backorder-template").text()),totalTemplate:_.template($(".sales-order-template-total").text()),titleTemplate:_.template($(".page-title").text()),initialize:function(){$(".app-container").html(this.el),this.render()},render:function(){$(this.el).append(this.template()),$(".put-title-here").html(this.titleTemplate()),$(".page-title").text("ORDERS"),this.getOrder()},getOrder:function(){var a=this,b=new Parse.Query("order");b.equalTo("objectId",this.options),b.include("customer"),b.find({success:function(b){a.order=b[0],a.showCustomer(a.order),$(".void-invoice").attr("id",b.id)},error:function(){}}).then(function(){a.getItems()})},showCustomer:function(a){console.log(a.attributes);var b=a.attributes.customer;console.log(b),$(".customer-info").append(this.customerTemplate({customer:b,order:a}))},getItems:function(){var a=this,b=new Parse.Query("itemInstance");b.equalTo("order",this.order),b.include("itemType"),b.find({success:function(b){b.length>0?b.forEach(function(b){a.showItem(b)}):$(".ship-head").html("")},error:function(){}}).then(function(){a.getBackOrders()})},getBackOrders:function(){var a=this,b=new Parse.Query("backOrder");b.equalTo("order",this.order),b.equalTo("item",void 0),b.find({success:function(b){b.length>0?b.forEach(function(b){var c=new Parse.Query("itemType");c.equalTo("UPC",b.attributes.itemType),c.first({success:function(c){a.showBackOrder(b,c)},error:function(){}})}):$(".backorder-head").html("")},error:function(){}}).then(function(){a.getTotal()})},showBackOrder:function(a,b){$(".backorder-items").append(this.backorderInstanceTemplate({backorder:a,type:b.attributes}))},showItem:function(a){$(".in-stock-items").append(this.itemInstanceTemplate({item:a,type:a.attributes.itemType}))},getTotal:function(){var a=this,b=0;setTimeout(function(){$(".item-price").each(function(){var a=parseInt(this.innerHTML.replace(/\s+/g,"").replace(/\,/g,"").substr(1));b+=a}),a.showTotal(b)},800)},showTotal:function(a){$(".backorder-items").append(this.totalTemplate({total:a}))},printSales:function(){window.print()},printInvoice:function(){window.print()},voidInvoiceItem:function(a){var b=$(".void-invoice").attr("id"),c=new Parse.Query("order");c.equalTo("objectId",b),c.find({success:function(a){var c=new Parse.Query("backOrder");c.equalTo("order",b),c.find({success:function(a){console.log(a)},error:function(){console.log("no backOrder")}}),a[0].set("void",!0),console.log(a[0].attributes),console.log("success")},error:function(){console.log("order not found")}}),console.log($(a.currentTarget).attr("id"))}}),ProfilePageView=Parse.View.extend({events:{"click .edit-profile-button":"toggleEditAttribute","click .save-profile-edit-button":"saveProfileEdit"},mainTemplate:_.template($(".profile-page-template").text()),titleTemplate:_.template($(".page-title").text()),profilePaymentTemplate:_.template($(".profile-payment-template").text()),initialize:function(){if(null===Parse.User.current()==!0)window.location.href="#",router.swap(new FrontPage);else{$(".progress-bar-body").html(""),$(".app-container").html(this.el);var a=window.location.hash.substring(1).toString();_.each($(".nav-link"),function(b){b.id==a?$(b).css("color","#ffffff"):$(b).css("color","#9d9d9d")}),this.render(),$(".payment-tab").css("cursor","not-allowed")}},render:function(){$(this.el).append(this.mainTemplate({user:Parse.User.current()})),$(".put-title-here").html(this.titleTemplate()),$(".page-title").text("PROFILE")},toggleEditAttribute:function(){$(event.target).hasClass("active")?(_.each($(".profile-edit"),function(){$(".profile-edit").prop("disabled","disabled")}),$(".save-profile-edit-button").css("opacity",0),$(event.target).removeClass("active")):(_.each($(".profile-edit"),function(){$(".profile-edit").prop("disabled",!1)}),$(".save-profile-edit-button").css("opacity",1),$(event.target).addClass("active"))},saveProfileEdit:function(){Parse.User.current().set({company:0!=$(".company-input").val().length?$(".company-input").val():Parse.User.current().get("company"),address:0!=$(".address-input").val().length?$(".address-input").val():Parse.User.current().get("address"),owner:$(".owner-input").val()?$(".owner-input").val():Parse.User.current().get("owner"),ffl:0!=$(".ffl-input").val().length?parseInt($(".ffl-input").val()):Parse.User.current().get("ffl"),username:0!=$(".username-input").val().length?$(".username-input").val():Parse.User.current().get("username"),email:0!=$(".email-input").val().length?$(".email-input").val():Parse.User.current().get("email")}).save(),$(".edit-profile-button").click(),$(".profile-edit").val(""),$(".company-input").prop("placeholder",Parse.User.current().get("company")),$(".address-input").prop("placeholder",Parse.User.current().get("address")),$(".owner-input").prop("placeholder",Parse.User.current().get("owner")),$(".ffl-input").prop("placeholder",Parse.User.current().get("ffl")),$(".username-input").prop("placeholder",Parse.User.current().get("username")),$(".email-input").prop("placeholder",Parse.User.current().get("email"))}}),signUpView=Parse.View.extend({events:{"click .submit-sign-up":"signUp","keydown .email-input":"enterSignUp","click .close":"closeAlert"},mainTemplate:_.template($(".sign-up-template").text()),titleTemplate:_.template($(".page-title").text()),initialize:function(){$(".app-container").html(this.el),this.render()},render:function(){$(this.el).append(this.mainTemplate({user:Parse.User.current()})),$(".put-title-here").html(this.titleTemplate()),$(".page-title").text("SIGN UP")},enterSignUp:function(a){console.log(a.which);var b=a.which;13==b&&this.signUp()},signUp:function(){var a=$(".username-input").val(),b=($(".username-input").val(),$(".password-input").val()),c=$(".email-input").val(),d=$(".address-input").val(),e=$(".owner-input").val(),f=$(".ffl-input").val(),g=new Parse.User;g.set({username:a,password:b,email:c,company:a,owner:e,address:d,ffl:f}),console.log(g);var h=!0;if(_.each($(".sign-up-field"),function(a){return $(a).val().length<1?void console.log("it's empty, foo!"):h=!1}),console.log(h),h===!1){var i=this;g.signUp(null,{success:function(a){console.log(a),a.save(),$(".app-container").html(""),i.remove(),router.swap(new ProfilePageView)
},error:function(a,b){console.log("Error: "+b.code+" "+b.message)}})}else $(".alert-danger").css({visibility:"visible",height:"auto","margin-bottom":"20px",padding:"15px"}),_.each($(".sign-up-field"),function(a){$(a).css("border","1px solid red")})},closeAlert:function(){$(".alert-danger").css({visibility:"hidden",height:"0px","margin-bottom":"0px",padding:"0px",overflow:"hidden"})}}),ContactPageView=Parse.View.extend({events:{},mainTemplate:_.template($(".contact-page-template").text()),titleTemplate:_.template($(".page-title").text()),initialize:function(){if(null===Parse.User.current()==!0)window.location.href="#",router.swap(new FrontPage);else{$(".app-container").html(this.el);var a=window.location.hash.substring(1).toString();_.each($(".nav-link"),function(b){b.id==a?$(b).css("color","#ffffff"):$(b).css("color","#9d9d9d")}),this.render()}},render:function(){$(this.el).append(this.mainTemplate({user:Parse.User.current()})),$(".put-title-here").html(this.titleTemplate()),$(".page-title").text("CONTACT US")}}),FullStockList=Parse.View.extend({events:{},template:_.template($(".stock-list-template").text()),stockItemTemplate:_.template($(".stock-list-item-template").text()),initialize:function(){if(null===Parse.User.current()==!0)window.location.href="#",router.swap(new FrontPage);else{$("html, body").scrollTop(0);var a=window.location.hash.substring(1).toString();_.each($(".nav-link"),function(b){b.id==a?$(b).css("color","#ffffff"):$(b).css("color","#9d9d9d")}),$(".app-container").html(this.el),this.render()}},render:function(){$(this.el).append(this.template()),this.getShelfItems()},getShelfItems:function(){var a=this;$(".stock-item-list-bound").html("");var b=new Parse.Query("itemInstance");b.equalTo("itemInstanceCode",void 0),b.each(function(b){$(".stock-item-list-bound").append(a.stockItemTemplate({item:b.attributes,model:b}))})}}),AppRouter=Parse.Router.extend({routes:{"":"frontPage","sign-up":"signUpPage",scan:"scanItem",inventory:"inventoryList",shelf:"shelfList","inventory/backorders":"backorderList","inventory/fullstock":"fullStockList",orders:"orderList",order:"placeOrder","order/:id":"finalOrder","order/print_list":"printList",customers:"customerList",profile:"profilePage",contact:"contactPage"},initialize:function(){this.navOptions=null,this.currentView=null},frontPage:function(){this.swap(new FrontPage)},signUpPage:function(){this.swap(new signUpView)},scanItem:function(){this.swap(new ScanItem)},inventoryList:function(){this.swap(new InventoryList)},shelfList:function(){this.swap(new ShelfList)},backorderList:function(){this.swap(new BackorderList)},fullStockList:function(){this.swap(new FullStockList)},orderList:function(){this.swap(new OrderList)},printList:function(a){this.swap(new OrderInstanceView(a))},orderStatus:function(a){this.swap(new OrderStatus({orderID:a}))},placeOrder:function(){this.swap(new PlaceOrder)},orderItems:function(a){this.swap(new OrderItemsView({shopID:a}))},attachForm3:function(a){this.swap(new AttachForm3({orderID:a}))},orderInvoice:function(a){this.swap(new OrderInvoice({orderID:a}))},orderPartial:function(a){this.swap(new OrderPartial({orderID:a}))},customerList:function(){this.swap(new CustomerList)},finalOrder:function(a){console.log(a),this.swap(new OrderInstanceView(a))},profilePage:function(){this.swap(new ProfilePageView)},contactPage:function(){this.swap(new ContactPageView({user:Parse.User.current()}))},itemEditView:function(){this.swap(new ItemEditView)},swap:function(a){this.currentView&&this.currentView.remove(),this.currentView=a}});Parse.initialize("20pXgK4OyuzpFjfqwFD1ARUDkWbAAhrofuXFasvj","R6BhdiUvc4ctMpuB2GnymOrbLnmFnRC7e04Gyynv");var router=new AppRouter;Parse.history.start(),$(".log-out").click(function(){Parse.User.logOut()});var theNumber=[],query=new Parse.Query("customer");query.limit(1500),query.find(function(a){a.forEach(function(a){theNumber.push(a)})}).then(function(){$(".customers-badge").text(theNumber.length)});var theOrders=[],query=new Parse.Query("orders");query.limit(1500),query.find(function(a){a.forEach(function(a){theOrders.push(a)})}).then(function(){$(".orders-badge").text(theOrders.length)}),$(function(){$('[data-toggle="tooltip"]').tooltip()});